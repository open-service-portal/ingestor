{{!--
  Cluster-Scoped Steps Template
  For cluster-scoped resources (no namespace in manifest)

  Available variables:
  - xrd: The full XRD object
  - metadata: Extraction metadata
  - helpers: Utility functions
  - source: Source of the XRD
  - timestamp: When extracted
--}}
    - id: create-resource
      name: Create {{xrd.spec.names.kind}}
      action: kubernetes:apply
      input:
        manifest: |
          apiVersion: {{xrd.spec.group}}/{{xrd.spec.versions.[0].name}}
          kind: {{xrd.spec.names.kind}}
          metadata:
            name: {{backstageVar "parameters.name"}}
          spec: {{backstageVar "parameters"}}

    - id: register
      name: Register in Catalog
      action: catalog:register
      input:
        repoContentsUrl: {{backstageVar "steps.create-resource.output.repoContentsUrl"}}
        catalogInfoPath: /catalog-info.yaml
